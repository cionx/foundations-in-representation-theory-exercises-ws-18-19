\section{}

We denote the given morphims as follows:
\begin{equation}
  \label{3x3 diagram}
  \begin{tikzcd}
      {}
    & 0
      \arrow{d}
    & 0
      \arrow{d}
    & 0
      \arrow{d}
    & {}
  \\
      0
      \arrow{r}
    & X'
      \arrow{r}[above]{\alpha'}
      \arrow{d}[right]{f'}
    & X
      \arrow{r}[above]{\beta'}
      \arrow{d}[right]{f}
    & X''
      \arrow{r}
      \arrow{d}[right]{f''}
    & 0
    \\
      0
      \arrow{r}
    & Y'
      \arrow{r}[above]{\alpha}
      \arrow{d}[right]{g'}
    & Y
      \arrow{r}[above]{\beta}
      \arrow{d}[right]{g}
    & Y''
      \arrow{r}
      \arrow{d}[right]{g''}
    & 0
    \\
      0
      \arrow{r}
    & Z'
      \arrow{r}[above]{\alpha''}
      \arrow{d}
    & Z
      \arrow{r}[above]{\beta''}
      \arrow{d}
    & Z''
      \arrow{r}
      \arrow{d}
    & 0
    \\
      {}
    & 0
    & 0
    & 0
    & {}
  \end{tikzcd}
\end{equation}
We consider the following three cases:

\begin{enumerate}[label = (\roman*)]
  \item
    The upper two rows are exact.
  \item
    The lower two rows are exact.
  \item
    The upper row and the lower row are exact.
\end{enumerate}





\subsection{}
\label{upper rows are exact}

By applying the snake lemma to the upper two rows we get an exact sequence
\begin{equation}
  \label{general snake sequence}
  0
  \to
  \ker(f')
  \to
  \ker(f)
  \to
  \ker(f'')
  \xlongto{\delta}
  \coker(f')
  \to
  \coker(f)
  \to
  \coker(f'')
  \to
  0 \,.
\end{equation}
The morphisms between the cokernels are the unique ones which make the diagram
\[
  \begin{tikzcd}
      Y'
      \arrow{r}
      \arrow{d}
    & Y
      \arrow{r}
      \arrow{d}
    & Y''
      \arrow{d}
    \\
      \coker(f')
      \arrow[dashed]{r}
    & \coker(f)
      \arrow[dashed]{r}
    & \coker(f'')
  \end{tikzcd}
\]
commute.
The morphisms~$f'$,~$f$,~$f''$ are monomorphisms, hence their kernels are given by~$\ker(f') = \ker(f) = \ker(f'') = 0$.
It follows from the (right) exactness of the columns of~\eqref{3x3 diagram} that~$g'$ is a cokernel of~$f'$, that~$g$ is a cokernel of~$f$ and that~$g''$ is a cokernel of~$f''$.
The induced morphisms~$Z' \to Z$ and~$Z \to Z''$ that make the diagram
\[
  \begin{tikzcd}
      Y'
      \arrow{r}
      \arrow{d}
    & Y
      \arrow{r}
      \arrow{d}
    & Y''
      \arrow{d}
    \\
      Z'
      \arrow[dashed]{r}
    & Z
      \arrow[dashed]{r}
    & Z''
  \end{tikzcd}
\]
commute and precisely~$\alpha''$ and~$\beta''$ from the last row of~\eqref{3x3 diagram} (by the uniqueness of these induced morphisms).

We have shows that the exact sequence~\eqref{general snake sequence} is (up to isomorphism) given by
\[
  0
  \to
  0
  \to
  0
  \to
  0
  \to
  Z'
  \xlongto{\alpha''}
  Z
  \xlongto{\beta''}
  Z''
  \to
  0 \,.
\]
This shows that the last row of~\eqref{3x3 diagram} is exact.





\subsection{}

This case follows by duality from case~\ref{upper rows are exact}





\subsection{}

We need to show the exactness of the sequence
\[
  0
  \to
  Y'
  \xlongto{\alpha}
  Y
  \xlongto{\beta}
  Y''
  \to
  0 \,,
\]
which amounts to showing the exactness of the three sequences
\[
  0 \to Y' \xlongto{\alpha} Y \,,
  \qquad
  Y' \xlongto{\alpha} Y \xlongto{\beta} Y'' \,,
  \qquad
  Y \xlongto{\beta} Y'' \to 0 \,.
\]

The exactness of the first sequence
\[
  0 \to Y' \xto{\alpha} Y
\]
is equivalent to~$\alpha$ being a monomorphisms.
That~$\alpha$ is indeed a monomorphism follows by applying one of the four lemmata (namely part~\ref{four lemma nice} of Exercise~3) to the first two columns of the diagram~\eqref{3x3 diagram};
because both~$\alpha'$ and~$\alpha''$ are monomorphisms it follows that~$\alpha$ is also one.

We find dually that the third sequence
\[
  Y \xto{\beta} Y'' \to 0
\]
is exact.

To show the exactness of the second sequence
\[
  Y' \xto{\alpha} Y \xto{\beta} Y''
\]
it remains to show that the induced morphism~$\lambda \colon \im(\alpha) \to \ker(\beta)$ is an isomorphism.
By~$\lambda$ we mean the unique morphism~$\im(\alpha) \to \ker(\beta)$ that makes the following diagram commute:
\[
  \begin{tikzcd}
      Y'
      \arrow{rr}[above]{\alpha}
      \arrow{dr}
    & {}
    & Y
      \arrow{rr}[above]{\beta}
    & {}
    & Y''
    \\
      {}
    & \im(\alpha)
      \arrow{ur}
      \arrow[dashed]{rr}[above]{\lambda}
    & {}
    & \ker(\beta)
      \arrow{ul}
    & {}
  \end{tikzcd}
\]
For the existence of this morphism we use the assumption~$\beta \alpha = 0$ (the uniqueness follows from the universal property of the kernel~$\ker(\beta) \to Y$).
To show that~$\lambda$ is indeed an isomorphism, we further expand the commutative diagram~\eqref{3x3 diagram} to the following commutative beauty:
\begin{equation}
  \label{enriched 3x3 diagram}
  \begin{tikzcd}[row sep = small]
      {}
    & 0
      \arrow{dd}
    & {}
    & 0
      \arrow{dd}
    & {}
    & 0
      \arrow{dd}
    & {}
  \\
      {}
    & {}
    & 0
    & {}
    & 0
    & {}
    & {}
  \\
      0
      \arrow{r}
    & X'
      \arrow{rr}[above,near start]{\alpha'}
      \arrow{dr}
      \arrow{dd}[right,near end]{f'}
    & {}
    & X
      \arrow{rr}[above,near end]{\beta'}
      \arrow{dd}[right,near end]{f}
    & {}
    & X''
      \arrow{r}
      \arrow{dd}[right,near end]{f''}
    & 0
    \\
      {}
    & {}
    & \im(\alpha')
      \arrow[from=uu,dashed,crossing over]
      \arrow{ur}
    & {}
    & \ker(\beta')
      \arrow{ul}
      \arrow[from=uu,dashed,crossing over]
      \arrow[from=ll, dashed, crossing over, "\lambda'", near start]
    & {}
    & {}
  \\
      0
      \arrow{r}
    & Y'
      \arrow{rr}[above,near start]{\alpha}
      \arrow{dr}
      \arrow{dd}[right,near end]{g'}
    & {}
    & Y
      \arrow{rr}[above,near end]{\beta}
      \arrow{dd}[right,near end]{g}
    & {}
    & Y''
      \arrow{r}
      \arrow{dd}[right,near end]{g''}
    & 0
    \\
      {}
    & {}
    & \im(\alpha)
      \arrow[from=uu,dashed,crossing over]
      \arrow{ur}
    & {}
    & \ker(\beta)
      \arrow{ul}
      \arrow[from=uu,dashed,crossing over]
      \arrow[from=ll, dashed, crossing over, "\lambda", near start]
    & {}
    & {}
  \\
      0
      \arrow{r}
    & Z'
      \arrow{rr}[above,near start]{\alpha''}
      \arrow{dr}
      \arrow{dd}
    & {}
    & Z
      \arrow{rr}[above,near end]{\beta''}
      \arrow{dd}
    & {}
    & Z''
      \arrow{r}
      \arrow{dd}
    & 0
    \\
      {}
    & {}
    & \im(\alpha'')
      \arrow[from=uu,dashed,crossing over]
      \arrow{ur}
    & {}
    & \ker(\alpha'')
      \arrow{ul}
      \arrow[from=uu,dashed,crossing over]
      \arrow[from=ll, dashed, crossing over, "\lambda''", near start]
    & {}
    & {}
    \\
      {}
    & 0
    & {}
    & 0
    & {}
    & 0
    & {}
    \\
      {}
    & {}
    & 0
      \arrow[from=uu,dashed,crossing over]
    & {}
    & 0
      \arrow[from=uu,dashed,crossing over]
    & {}
    & {}
  \end{tikzcd}
\end{equation}
We have in particular the following commutative diagram:
\begin{equation}
  \label{where to apply 5 lemma}
  \begin{tikzcd}
      0
      \arrow{r}
    & \im(\alpha')
      \arrow{r}
      \arrow{d}[right]{\lambda'}
    & \im(\alpha)
      \arrow{r}
      \arrow{d}[right]{\lambda}
    & \im(\alpha'')
      \arrow{r}
      \arrow{d}[right]{\lambda''}
    & 0
    \\
      0
      \arrow{r}
    & \ker(\beta')
      \arrow{r}
    & \ker(\beta)
      \arrow{r}
    & \ker(\beta'')
      \arrow{r}
    & 0
  \end{tikzcd}
\end{equation}
The rows of this diagram are again exact:

To see the exactness of the lower row we apply the snake lemma to the diagram
\[
  \begin{tikzcd}
      0
      \arrow{r}
    & X
      \arrow{r}[above]{f}
      \arrow{d}[right]{\beta'}
    & Y
      \arrow{r}[above]{g}
      \arrow{d}[right]{\beta}
    & Z
      \arrow{r}
      \arrow{d}[right]{\beta''}
    & 0
    \\
      0
      \arrow{r}
    & X''
      \arrow{r}[above]{f''}
    & Y''
      \arrow{r}[above]{g''}
    & Z''
      \arrow{r}
    & 0
  \end{tikzcd}
\]
to get the exact sequence
\[
  0
  \to
  \ker(\beta')
  \to
  \ker(\beta)
  \to
  \ker(\beta'')
  \xlongto{\delta}
  0
  \to
  0
  \to
  0
  \to
  0 \,,
\]
where we use that~$\coker(\beta') = \coker(\beta) = \coker(\beta'') = 0$ because~$\beta'$,~$\beta$,~$\beta''$ are epimorphisms.

We argue in a similar way for the exactness of the lower row of~\eqref{where to apply 5 lemma}:
We first apply the snake lemma to the diagram
\[
  \begin{tikzcd}
      0
      \arrow{r}
    & X'
      \arrow{r}[above]{f'}
      \arrow{d}[right]{\alpha'}
    & Y'
      \arrow{r}[above]{g'}
      \arrow{d}[right]{\alpha}
    & Z'
      \arrow{r}
      \arrow{d}[right]{\alpha''}
    & 0
    \\
      0
      \arrow{r}
    & X
      \arrow{r}[above]{f}
    & Y
      \arrow{r}[above]{g}
    & Z
      \arrow{r}
    & 0
  \end{tikzcd}
\]
to get the exact sequence
\[
  0
  \to
  0
  \to
  0
  \to
  0
  \xlongto{\delta}
  \coker(\alpha')
  \to
  \coker(\alpha)
  \to
  \coker(\alpha'')
  \to
  0 \,,
\]
where we use that~$\ker(\alpha') = \ker(\alpha) = \ker(\alpha'') = 0$ because~$\alpha'$,~$\alpha$,~$\alpha''$ are monomorphisms.
This shows that in the intermediate diagram
\[
  \begin{tikzcd}
      0
      \arrow{r}
    & X
      \arrow{r}[above]{f}
      \arrow{d}
    & Y
      \arrow{r}[above]{g}
      \arrow{d}
    & Z
      \arrow{r}
      \arrow{d}
    & 0
    \\
      0
      \arrow{r}
    & \coker(\alpha')
      \arrow{r}
    & \coker(\alpha)
      \arrow{r}
    & \coker(\alpha'')
      \arrow{r}
    & 0
  \end{tikzcd}
\]
the rows are again exact.
We can therefore apply the snake lemma again.
This time we get the exact sequence
\[
  0
  \to
  \im(\alpha')
  \to
  \im(\alpha)
  \to
  \im(\alpha'')
  \xlongto{\delta}
  0
  \to
  0
  \to
  0
  \to
  0 \,,
\]
where we use that the morphisms~$X \to \coker(\alpha')$,~$Y \to \coker(\alpha)$ and~$Z \to \coker(\alpha'')$ are epimorphisms.

We have now shown that both rows of~$\eqref{where to apply 5 lemma}$ are exact.
We know that both~$\lambda'$ and~$\lambda''$ are isomorphisms because the upper and lower rows of~\eqref{3x3 diagram} are exact.
It follows from the five lemma that~$\lambda$ is again an isomorphism, which shows the desired exactness.









